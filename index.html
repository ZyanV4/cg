<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Chat</title>
    <link rel="shortcut icon" href="https://zyanv4.my.id/assets/images/1701690928_3605654cb14eef283384.png">
    <link rel="stylesheet" href="https://zyanv4.my.id/assets/css/partikel.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&amp;display=swap" rel="stylesheet">
    <style>
        :root {
            --warna: #383c3d;
            --warna_2: #0a0c14;
            --warna_3: #9b02fc;
            --warna_4: #0f111c;
            --warna_5: #191e31;
            --warna_6: #2f107c;
            --warna_7: rgba(18, 18, 18, 1);
            --warna_8: linear-gradient(90deg, hsla(0,0%,0%,0), hsl(210,4%,64%), hsla(0,0%,0%,0));
            --warna_9: #252525;
            --warna_10: #454545;
            --warna_11: #222;
            --warna_12: #333;
            --warna_13: #1c1c1c;
            --warna_14: #008ef0;
            --warna_15: linear-gradient(45deg, var(--warna_3) 35%, var(--warna_14));
            --warna_16: linear-gradient(45deg, #9b02fcad 35%, #008ef0ad);
            --warna_17: #2d2d2d;
            --warna_18: #353535;
            --warna_19: #717171;
            --warna_20: #ddd;
            --warna_21: #262432;
            --warna_22: #580190;

            --body_background: #0f0f0f;
            --navbar_background: #fff;
            --section_background: #1a1a1a;
            --accordion_button: #272727;
            --sidebar_items: #363636;            
        }
        body, html {
            font-family: 'Poppins', sans-serif;
            -webkit-font-smoothing: antialiased;
            -webkit-text-size-adjust: 100%;
        }
        body {
            background: var(--body_background);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            font-size: 14px;
            letter-spacing: .5px;
            caret-color: var(--warna_3);
        }
        ::selection {
            background: var(--warna_3);
            color: #fff;
        }
        /* width */
        ::-webkit-scrollbar {
            width: 7px;
            height: 12px;
        }
        /* Track */
        ::-webkit-scrollbar-track {
            background: #eee; 
            border-radius: 6px;
        }
        /* Handle */
        ::-webkit-scrollbar-thumb {
            background: var(--warna_3);
            height: 32px;
            border-radius: 6px;
        }
        /* Handle on hover */
        ::-webkit-scrollbar-thumb:hover {
            background: var(--warna_3); 
        }
        .chatsection {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 100%;
        }
        #chat-container {
            width: 95%;
            max-width: 1200px;
            height: 90vh;
            max-height: 640px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 0 auto;
        }

        #chat-window {
            flex: 1;
            padding: 20px;
            overflow: auto;
            background: var(--section_background);
            z-index: 1;
        }

        #output {
            display: flex;
            flex-direction: column;
        }

        .message {
            margin-bottom: 15px;
            padding: 8px 15px;
            border-radius: 5px;
            max-width: 70%;
            word-wrap: break-word;
        }

        .message.user {
            align-self: flex-end;
            background: var(--warna_3);
            color: white;
        }

        .message.other {
            align-self: flex-start;
            background: #353535;
            color: white;
        }

        #input-container {
            display: flex;
            border-top: 1px solid transparent;
            background: #353535;
            padding: 10px;
            z-index: 1;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
        }

        #message {
            flex: 1;
            padding: 10px 15px;
            margin: 5px;
            border: none;
            border-radius: 8px;
            border: 1px solid var(--body_background);
            background: var(--body_background);
            color: white;
        }

        #kirim {
            color: white;
            cursor: pointer;
            border: none;
            filter: drop-shadow(0px 0px 37.6px var(--warna_3));
            background: var(--warna_3);
            border-color: var(--warna_3);
            font-size: .875rem;
            text-transform: capitalize;
            border-radius: 8px;
            box-shadow: 0px 0px 20.6px var(--warna_3);
            font-weight: 700;
            padding: 10px 25px;
            margin: 5px;
        }

        #reset {
            color: white;
            cursor: pointer;
            border: none;
            filter: drop-shadow(0px 0px 37.6px var(--warna_14));
            background: var(--warna_14);
            border-color: var(--warna_14);
            font-size: .875rem;
            text-transform: capitalize;
            border-radius: 8px;
            box-shadow: 0px 0px 20.6px var(--warna_14);
            font-weight: 700;
            padding: 10px 25px;
            margin: 5px;
        }

        /* Nama pengguna container */
        #username-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            width: 100%;
            background: var(--section_background);
            position: absolute;
            top: 0;
            left: 0;
        }

        #username-input {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 1rem;
        }

        #username-submit {
            color: white;
            cursor: pointer;
            border: none;
            background: var(--warna_3);
            border-color: var(--warna_3);
            font-size: .875rem;
            text-transform: capitalize;
            border-radius: 8px;
            box-shadow: 0px 0px 20.6px var(--warna_3);
            font-weight: 700;
            padding: 10px 25px;
        }

        /* Reply container */
        .reply-container {
            display: none;
            background: var(--warna_4);
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
            color: white;
        }

        .reply-message {
            font-weight: bold;
            font-size: 0.9rem;
        }

        .cancel-reply {
            float: right;
            cursor: pointer;
            color: red;
        }

    </style>
    <!-- Tambahkan Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getDatabase, ref, push, onChildAdded, onValue, get, remove } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBbbSrAKPDZccp5Cj5YUFQZWaU5g4irEYA",
            authDomain: "global-chat-526ec.firebaseapp.com",
            databaseURL: "https://global-chat-526ec-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "global-chat-526ec",
            storageBucket: "global-chat-526ec.appspot.com",
            messagingSenderId: "150505197846",
            appId: "1:150505197846:web:805e18b6fcbeb3e08ad308"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        document.addEventListener("DOMContentLoaded", function() {
            const messageInput = document.getElementById("message");
            const kirimButton = document.getElementById("kirim");
            const resetButton = document.getElementById("reset");
            const chatWindow = document.getElementById("chat-window");
            const output = document.getElementById("output");
            const usernameContainer = document.getElementById("username-container");
            const usernameInput = document.getElementById("username-input");
            const usernameSubmit = document.getElementById("username-submit");

            let username = '';

            usernameSubmit.addEventListener("click", function() {
                username = usernameInput.value.trim();
                if (username !== "") {
                    usernameContainer.style.display = "none";
                }
            });

            kirimButton.addEventListener("click", function() {
                const message = messageInput.value.trim();
                if (message !== "") {
                    push(ref(db, "messages"), {
                        message: message,
                        sender: username,
                        timestamp: new Date().toISOString()
                    });
                    messageInput.value = "";
                }
            });

            resetButton.addEventListener("click", function() {
                const messagesRef = ref(db, "messages");
                get(messagesRef).then((snapshot) => {
                    snapshot.forEach((childSnapshot) => {
                        remove(childSnapshot.ref);
                    });
                });
            });

            messageInput.addEventListener("keypress", function(event) {
                if (event.key === "Enter") {
                    event.preventDefault();
                    kirimButton.click();
                }
            });

            onChildAdded(ref(db, "messages"), function(snapshot) {
                const data = snapshot.val();
                const messageElement = document.createElement("div");
                messageElement.classList.add("message", data.sender === username ? "user" : "other");
                messageElement.textContent = `${data.sender}: ${data.message}`;
                output.appendChild(messageElement);
                chatWindow.scrollTop = chatWindow.scrollHeight;
            });
        });
    </script>
</head>
<body>
    <div id="username-container">
        <input type="text" id="username-input" placeholder="Enter your name">
        <button id="username-submit">Join Chat</button>
    </div>
    <div class="chatsection">
        <div id="chat-container">
            <div id="chat-window">
                <div id="output"></div>
            </div>
            <div id="input-container">
                <input type="text" id="message" placeholder="Type your message...">
                <button id="kirim">Send</button>
                <button id="reset">Reset</button>
            </div>
        </div>
    </div>
</body>
</html>
